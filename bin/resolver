#!/usr/bin/env php
<?php

include_once __DIR__."/../src/Message/Header.php";
include_once __DIR__."/../src/Message/Query.php";
include_once __DIR__."/../src/Message/Answer.php";
include_once __DIR__."/../src/Message/Classes.php";
include_once __DIR__."/../src/Message/Types.php";
include_once __DIR__."/../src/Message/OPcodes.php";
include_once __DIR__."/../src/Message/Rcodes.php";
include_once __DIR__."/../src/Record/Record.php";
include_once __DIR__."/../src/Network/InetAddress.php";
include_once __DIR__."/../src/Network/Packet.php";
include_once __DIR__."/../src/Server/DatagramServer.php";
include_once __DIR__."/../src/Server/NameServer.php";
include_once __DIR__."/../src/Server/RequestHandler.php";
include_once __DIR__."/../src/System/Logger.php";
include_once __DIR__."/../src/System/Time.php";
include_once __DIR__."/../src/Exception/SocketException.php";
include_once __DIR__."/../src/Exception/SocketIOException.php";

cli_set_process_title("Resolver");
error_reporting(E_ALL);

const DNS_SERVER_ADDRESS = "127.0.0.1";
const DNS_SERVER_PORT    = 53;

$datagram = new Resolver\Server\DatagramServer();
$datagram->create(
	new Resolver\Network\InetAddress(DNS_SERVER_ADDRESS),
	DNS_SERVER_PORT
);

$server = new Resolver\Server\NameServer($datagram);
$server->run();
